# Опис інфраструктурної моделі проекту "БукМаркет"

## Загальна архітектура

Архітектура платформи "БукМаркет" базується на мікросервісному підході з розгортанням в хмарній інфраструктурі AWS. Система розроблена з урахуванням вимог високої доступності, масштабованості та безпеки.

## Опис ключових компонентів

### Рівень доступу користувачів

- **Route 53 (DNS)**: Служба доменних імен, яка маршрутизує запити користувачів до відповідних сервісів.
- **CloudFront (CDN)**: Сервіс доставки контенту, який кешує статичні ресурси (зображення, CSS, JavaScript) на серверах по всьому світу для швидкого доступу.

### Рівень безпеки

- **WAF (Web Application Firewall)**: Забезпечує захист від поширених веб-вразливостей (XSS, SQL-ін'єкції, CSRF).
- **Shield**: Сервіс захисту від DDoS-атак, забезпечує захист інфраструктури від розподілених атак.

### Рівень балансування навантаження

- **ELB (Elastic Load Balancer)**: Розподіляє вхідний трафік між декількома екземплярами фронтенд-додатків для забезпечення високої доступності.

### Рівень фронтенду

- **Elastic Beanstalk (Web App)**: Сервіс для розгортання та масштабування веб-додатків на базі React.js (SPA). Використовуються декілька екземплярів для забезпечення відмовостійкості.

### Рівень мікросервісів

- **ECS (Elastic Container Service)**: Сервіс для запуску та масштабування контейнеризованих мікросервісів:
  - **Сервіс авторизації**: Відповідає за автентифікацію та авторизацію користувачів.
  - **Сервіс каталогу**: Управляє каталогом книг та пошуком.
  - **Сервіс повідомлень**: Забезпечує комунікацію між користувачами.
  - **Сервіс транзакцій**: Керує процесами покупки, оплати та обміну книг.
  - **Сервіс доставки**: Інтегрується з логістичними сервісами для організації доставки.

- **Lambda (Сервіс сповіщень)**: Безсерверна функція для генерації та відправки сповіщень користувачам (email, push-повідомлення).

### Рівень баз даних

- **MongoDB Atlas**: Основна NoSQL база даних для зберігання даних користувачів, книг, транзакцій тощо.
- **Redis (ElastiCache)**: Сервіс кешування для швидкого доступу до часто запитуваних даних.
- **ElasticSearch**: Забезпечує повнотекстовий пошук по каталогу книг.

### Платіжні системи

- **Платіжні системи**: Інтеграція з зовнішніми платіжними системами (Stripe, PayPal, LiqPay) для обробки платежів.

### Рівень зберігання даних

- **S3 (Simple Storage Service)**:
  - **Зображення книг**: Зберігання фотографій та зображень.
  - **Логи та архіви**: Зберігання системних логів та архівів даних.

### Асинхронна комунікація

- **SQS (Simple Queue Service)**: Черга повідомлень для надійної асинхронної обробки операцій.
- **SNS (Simple Notification Service)**: Сервіс сповіщень для відправки повідомлень користувачам.

### CI/CD

- **CodeCommit**: Сервіс для зберігання версій коду та управління репозиторіями.
- **CodeBuild**: Сервіс для автоматичної збірки та тестування додатків.
- **CodePipeline**: Сервіс для безперервної інтеграції та доставки (CI/CD) для автоматизації процесу релізу.

### Аналітика

- **Kinesis**: Сервіс для збору, обробки та аналізу даних в реальному часі.
- **Аналітична BD**: База даних для зберігання та аналізу даних про використання системи.

### Моніторинг

- **CloudWatch**: Сервіс для моніторингу ресурсів та додатків, збору метрик та налаштування сповіщень.

## Взаємодія компонентів

1. Запит користувача потрапляє до маршрутизатора (Route 53), звідки направляється до CDN.
2. CDN перевіряє, чи є запитуваний контент в кеші, якщо так - повертає його користувачу.
3. Якщо контент не закешований, запит проходить через шар безпеки (WAF, Shield).
4. Балансувальник навантаження направляє запит до доступного екземпляра фронтенд-додатка.
5. Фронтенд-додаток взаємодіє з відповідними мікросервісами через API.
6. Мікросервіси взаємодіють з базами даних, сховищами та зовнішніми сервісами.
7. Для асинхронних операцій використовуються черги повідомлень (SQS) та служба сповіщень (SNS).
8. Всі компоненти логують свою роботу в CloudWatch для моніторингу та аналізу.

## Аспекти безпеки

1. Весь трафік шифрується за допомогою TLS.
2. WAF захищає від основних типів атак на веб-додатки.
3. Shield забезпечує захист від DDoS-атак.
4. Cognito використовується для управління користувачами та забезпечення безпечної автентифікації.
5. Платіжні дані не зберігаються в системі, а обробляються зовнішніми PCI DSS-сертифікованими сервісами.

## Масштабування

Архітектура підтримує як горизонтальне, так і вертикальне масштабування:

1. Фронтенд-додатки можуть автоматично масштабуватися в залежності від навантаження.
2. Мікросервіси в ECS масштабуються через збільшення кількості контейнерів.
3. Бази даних масштабуються через шардинг та реплікацію.
4. CDN та балансувальники навантаження забезпечують розподіл трафіку.

## Відмовостійкість

1. Використання декількох зон доступності для резервування.
2. Автоматичне відновлення сервісів при збоях.
3. Резервне копіювання даних з регулярним розкладом.
4. Асинхронна обробка критичних операцій для забезпечення надійності.

## Моніторинг та логування

1. CloudWatch для збору метрик та логів.
2. Налаштовані сповіщення для критичних подій.
3. Аналіз продуктивності та використання ресурсів.
4. Трасування запитів через різні компоненти системи. 

Загальна схема проекту "БукМаркет":

![Infrastructure description](./images/infrastructure_description.png)